<!DOCTYPE html>
<html>
<head>
    <title>üß™ Test Google Sheets Integration</title>
    <style>
        body { font-family: Arial; margin: 20px; background: #f5f5f5; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .test-form { border: 2px solid #ddd; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .success { background: #d4edda; border-color: #c3e6cb; color: #155724; }
        .error { background: #f8d7da; border-color: #f5c6cb; color: #721c24; }
        .loading { background: #fff3cd; border-color: #ffeaa7; color: #856404; }
        input, select { width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ddd; border-radius: 4px; }
        button { background: #007bff; color: white; padding: 12px 24px; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: bold; }
        button:hover { background: #0056b3; }
        button:disabled { background: #6c757d; cursor: not-allowed; }
        .result { margin-top: 20px; padding: 15px; border-radius: 6px; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
        .icon { font-size: 1.2em; margin-right: 8px; }
    </style>
</head>
<body>

<div class="container">
    <h1>üß™ Test Google Sheets Integration</h1>
    <p>Test apakah data form bisa masuk ke Google Sheets dengan benar.</p>
    
    <div class="test-form">
        <h3>üìù Form Test Data</h3>
        <form id="testForm">
            <label><strong>Nama:</strong></label>
            <input type="text" name="nama" value="Test User Google Sheets" required>
            
            <label><strong>WhatsApp:</strong></label>
            <input type="tel" name="whatsapp" value="6281234567890" required>
            
            <label><strong>Email:</strong></label>
            <input type="email" name="email" value="test@googlesheets.com">
            
            <label><strong>Sapaan:</strong></label>
            <select name="sapaan">
                <option value="Bapak">Bapak</option>
                <option value="Ibu">Ibu</option>
                <option value="Mas">Mas</option>
                <option value="Mbak">Mbak</option>
            </select>
            
            <label><strong>Asal Kota:</strong></label>
            <input type="text" name="asal_kota" value="Jakarta">
            
            <label><strong>Status:</strong></label>
            <input type="text" name="status" value="Pemula Ingin Belajar Jualan Umroh">
            
            <br><br>
            <button type="submit" id="submitBtn">
                <span class="icon">üöÄ</span>
                KIRIM KE GOOGLE SHEETS
            </button>
        </form>
    </div>
    
    <div id="result"></div>
</div>

<script>
document.getElementById('testForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const submitBtn = document.getElementById('submitBtn');
    const resultDiv = document.getElementById('result');
    
    // Show loading state
    submitBtn.disabled = true;
    submitBtn.innerHTML = '<span class="icon">‚è≥</span>Mengirim...';
    
    resultDiv.innerHTML = `
        <div class="result loading">
            <span class="icon">‚è≥</span>
            <strong>Sedang mengirim data ke Google Sheets...</strong>
            <p>Please wait...</p>
        </div>`;
    
    // Collect form data
    const formData = new FormData(this);
    
    // Add additional data (sama seperti di modal registration)
    formData.append('agent_id', '9aa42b31882ec039965f3c4923ce901b');
    formData.append('user_agent', navigator.userAgent);
    formData.append('timestamp', new Date().toISOString());
    
    // Send to Google Apps Script
    fetch('https://script.google.com/macros/s/AKfycbwjFWGkXoOExIU-6JjeN8mVpvj23xwgRhpTRjo6qd8FFdjvfcC3W7RvdLeyD0yBg5yS/exec', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        console.log('Google Sheets Response:', data);
        
        if (data.success) {
            resultDiv.innerHTML = `
                <div class="result success">
                    <span class="icon">‚úÖ</span>
                    <strong>SUCCESS! Data berhasil masuk ke Google Sheets!</strong>
                    <p><strong>Message:</strong> ${data.message}</p>
                    <p><strong>Timestamp:</strong> ${data.timestamp}</p>
                    <p><strong>Row:</strong> ${data.row}</p>
                    
                    <h4>üìã Data yang didikirm:</h4>
                    <pre>${JSON.stringify(Object.fromEntries(formData), null, 2)}</pre>
                    
                    <h4>üéâ Next Steps:</h4>
                    <p>‚úÖ Cek Google Sheets untuk memastikan data masuk</p>
                    <p>‚úÖ Google Sheets integration READY untuk production!</p>
                    <p>‚úÖ Form registration di landing page akan otomatis kirim ke Sheets</p>
                </div>`;
        } else {
            resultDiv.innerHTML = `
                <div class="result error">
                    <span class="icon">‚ùå</span>
                    <strong>ERROR! Data gagal masuk ke Google Sheets</strong>
                    <p><strong>Error:</strong> ${data.error || 'Unknown error'}</p>
                    
                    <h4>üîß Troubleshooting:</h4>
                    <p>1. Pastikan Google Apps Script sudah di-deploy dengan benar</p>
                    <p>2. Cek permission Apps Script (Anyone can access)</p>
                    <p>3. Pastikan Google Sheets tidak dalam mode protected</p>
                    
                    <details>
                        <summary>üìã Full Response</summary>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    </details>
                </div>`;
        }
    })
    .catch(error => {
        console.error('Error:', error);
        
        resultDiv.innerHTML = `
            <div class="result error">
                <span class="icon">üö´</span>
                <strong>NETWORK ERROR!</strong>
                <p><strong>Error:</strong> ${error.message}</p>
                
                <h4>üîß Possible Issues:</h4>
                <p>1. Internet connection problem</p>
                <p>2. Google Apps Script URL tidak accessible</p>
                <p>3. CORS policy blocking the request</p>
                
                <p><strong>Apps Script URL:</strong></p>
                <pre>https://script.google.com/macros/s/AKfycbwjFWGkXoOExIU-6JjeN8mVpvj23xwgRhpTRjo6qd8FFdjvfcC3W7RvdLeyD0yBg5yS/exec</pre>
            </div>`;
    })
    .finally(() => {
        // Reset button
        submitBtn.disabled = false;
        submitBtn.innerHTML = '<span class="icon">üöÄ</span>KIRIM KE GOOGLE SHEETS';
    });
});
</script>

</body>
</html> 